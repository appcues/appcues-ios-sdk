{"schemaVersion":{"patch":0,"minor":3,"major":0},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/tutorials\/appcueskit\/permissionprimers"]}],"hierarchy":{"paths":[["doc:\/\/com.appcues.sdk\/tutorials\/UseCases","doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/$volume","doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/Permission-Primers"]],"reference":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases","modules":[{"projects":[{"sections":[{"reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial#Configure-Appcues-Studio","kind":"task"},{"kind":"task","reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial#In-app-configuration"}],"reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial"}],"reference":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/Manual-Push-Notifications"},{"reference":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/Permission-Primers","projects":[{"sections":[{"kind":"task","reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#In-app-configuration"},{"kind":"task","reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#Create-the-flow-in-Appcues-Mobile-Builder"},{"kind":"task","reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#Target-the-flow-in-Appcues-Studio"}],"reference":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers"}]}]},"kind":"project","metadata":{"role":"project","category":"AppcuesKit","title":"Creating a Camera Permission Primers","categoryPathComponent":"UseCases"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers"},"sections":[{"title":"Creating a Camera Permission Primers","content":[{"type":"paragraph","inlineContent":[{"text":"This tutorial creates a permission primer for camera usage, but the same process can be used for other protected resources.","type":"text"}]}],"chapter":"Permission Primers","kind":"hero","estimatedTimeInMinutes":30},{"tasks":[{"contentSection":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Configure your app to report the permission status as an Appcues profile attribute and configure the Appcues iOS SDK to be able to trigger the permission prompt."}]}],"kind":"contentAndMedia","mediaPosition":"trailing"}],"anchor":"In-app-configuration","title":"In-app configuration","stepsSection":[{"caption":[{"type":"paragraph","inlineContent":[{"text":"To use protected device resources, a usage description for the resource must be provided, and the permission request must be triggered. If no usage description is provided in your apps Info.plist file, your app will be rejected during App Store review.","type":"text"}]}],"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Add a "},{"type":"codeVoice","code":"NSCameraUsageDescription"},{"text":" to your Info.plist.","type":"text"}]}],"media":null,"code":"PermissionPrimers-01-01.plist","runtimePreview":null,"type":"step"},{"media":null,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Create an extension on "},{"code":"AVAuthorizationStatus","type":"codeVoice"},{"text":" to get a standardized, human-readable string for each possible status.","type":"text"}]}],"runtimePreview":null,"type":"step","caption":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This status value will be used for the Appcues user profile property."}]}],"code":"PermissionPrimers-01-02.swift"},{"caption":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Having an up-to-date profile property allows for targeting an Appcues flow to the latest property value."}]}],"media":null,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Update your existing "},{"type":"codeVoice","code":"Appcues.identify()"},{"text":" call to set a user property with the current camera permission status.","type":"text"}]}],"type":"step","code":"PermissionPrimers-01-03.swift","runtimePreview":null},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Configure the "},{"identifier":"doc:\/\/com.appcues.sdk\/documentation\/AppcuesKit\/Appcues\/analyticsDelegate","isActive":true,"type":"reference"},{"type":"text","text":" of your Appcues instance."}]}],"caption":[{"inlineContent":[{"type":"text","text":"The analytics delegate is notified of every event handled within the Appcues iOS SDK, and allows us to detect the event that will trigger the system permission prompt."}],"type":"paragraph"}],"media":null,"type":"step","code":"PermissionPrimers-01-04.swift","runtimePreview":null},{"code":"PermissionPrimers-01-05.swift","caption":[{"inlineContent":[{"text":"A flow can trigger an event with this name to execute the system permission prompt.","type":"text"}],"type":"paragraph"}],"type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Filter for an event with value "},{"type":"codeVoice","code":"request-permission-camera"},{"type":"text","text":" and call "},{"code":"AVCaptureDevice.requestAccess","type":"codeVoice"},{"type":"text","text":"."}]}],"media":null,"runtimePreview":null},{"media":null,"caption":[],"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Update the completion callback to save the new state."}]}],"type":"step","code":"PermissionPrimers-01-06.swift","runtimePreview":null}]},{"stepsSection":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Create a new flow for your permission primer.","type":"text"}]}],"caption":[],"media":"PermissionPrimers-02-01.png","code":null,"runtimePreview":null,"type":"step"},{"runtimePreview":null,"content":[{"inlineContent":[{"type":"text","text":"Design your flow."}],"type":"paragraph"}],"caption":[{"inlineContent":[{"type":"text","text":"Consider reviewing the "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/accessing-private-data#Pre-alert-screens"},{"type":"text","text":"."}],"type":"paragraph"}],"code":null,"type":"step","media":"PermissionPrimers-02-02.png"},{"content":[{"type":"paragraph","inlineContent":[{"text":"Set the Actions for your button to “Dismiss Flow”, enable the Track event toggle, and use ","type":"text"},{"code":"request-permission-camera","type":"codeVoice"},{"type":"text","text":" as the event name."}]}],"caption":[],"code":null,"media":"PermissionPrimers-02-03.png","runtimePreview":null,"type":"step"}],"contentSection":[{"kind":"contentAndMedia","content":[{"inlineContent":[{"text":"Create a flow to trigger the permission prompt in the Appcues Mobile Builder.","type":"text"}],"type":"paragraph"}],"mediaPosition":"trailing"}],"title":"Create the flow in Appcues Mobile Builder","anchor":"Create-the-flow-in-Appcues-Mobile-Builder"},{"anchor":"Target-the-flow-in-Appcues-Studio","stepsSection":[{"type":"step","media":"PermissionPrimers-03-01.png","code":null,"runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"text":"Set the Audience targeting for the flow to “Specific users”. Select “User property”, “Permission Status Camera”, “equals”, “notDetermined”.","type":"text"}]}],"caption":[{"inlineContent":[{"type":"text","text":"This ensures only users who haven’t been prompted to grant access to the camera will be shown the flow."}],"type":"paragraph"}]},{"media":null,"code":null,"caption":[],"runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"text":"Configure the Trigger and Screen targeting rules for your use case.","type":"text"}]}],"type":"step"},{"media":null,"runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"text":"Publish!","type":"text"}]}],"code":null,"caption":[],"type":"step"}],"contentSection":[{"mediaPosition":"trailing","kind":"contentAndMedia","content":[{"type":"paragraph","inlineContent":[{"text":"Configure a flow to target users who haven’t been prompted to grant permission.","type":"text"}]}]}],"title":"Target the flow in Appcues Studio"}],"kind":"tasks"}],"references":{"doc://com.appcues.sdk/tutorials/UseCases/Manual-Push-Notifications":{"type":"topic","role":"article","abstract":[],"title":"Manual Push Notifications","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/Manual-Push-Notifications","url":"\/tutorials\/usecases\/manual-push-notifications","kind":"article"},"PermissionPrimers-01-01.plist":{"type":"file","fileType":"plist","content":["<?xml version=\"1.0\" encoding=\"UTF-8\"?>","<!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">","<plist version=\"1.0\">","<dict>","    <key>CFBundleDisplayName<\/key>","    <string>My App<\/string>","    <!-- Other properties... -->","    <key>NSCameraUsageDescription<\/key>","    <string>The app takes photos of food.<\/string>","<\/dict>","<\/plist>"],"identifier":"PermissionPrimers-01-01.plist","highlights":[{"line":8},{"line":9}],"fileName":"Info.plist","syntax":"plist"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PermissionPrimers":{"type":"topic","role":"project","abstract":[{"text":"This tutorial creates a permission primer for camera usage, but the same process can be used for other protected resources.","type":"text"}],"title":"Creating a Camera Permission Primers","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers","estimatedTime":"30min","url":"\/tutorials\/appcueskit\/permissionprimers","kind":"project"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PushNotificationsTutorial#In-app-configuration":{"type":"section","role":"pseudoSymbol","abstract":[{"text":"This tutorial manually configures push notifications for an app.","type":"text"}],"title":"In-app configuration","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial#In-app-configuration","url":"\/tutorials\/appcueskit\/pushnotificationstutorial#In-app-configuration","kind":"section"},"doc://com.appcues.sdk/tutorials/UseCases":{"url":"\/tutorials\/usecases","role":"overview","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases","title":"Using AppcuesKit","kind":"overview","type":"topic","abstract":[{"type":"text","text":"Integrate Appcues experiences into your native iOS and iPadOS apps."}]},"doc://com.appcues.sdk/tutorials/AppcuesKit/PushNotificationsTutorial":{"type":"topic","role":"project","abstract":[{"text":"This tutorial manually configures push notifications for an app.","type":"text"}],"title":"Manually Adding Support for Push Notifications","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial","estimatedTime":"30min","url":"\/tutorials\/appcueskit\/pushnotificationstutorial","kind":"project"},"PermissionPrimers-01-02.swift":{"fileType":"swift","syntax":"swift","content":["extension AVAuthorizationStatus {","    var description: String {","        switch self {","        case .notDetermined:","            return \"notDetermined\"","        case .restricted:","            return \"restricted\"","        case .denied:","            return \"denied\"","        case .authorized:","            return \"authorized\"","        @unknown default:","            return \"unknown\"","        }","    }","}"],"type":"file","highlights":[],"identifier":"PermissionPrimers-01-02.swift","fileName":"AVAuthorizationStatus+Description.swift"},"PermissionPrimers-01-04.swift":{"type":"file","fileType":"swift","content":["import UIKit","import AppcuesKit","","@main","class AppDelegate: UIResponder, UIApplicationDelegate {","","    func application(","        _ application: UIApplication, didFinishLaunchingWithOptions","        launchOptions: [UIApplication.LaunchOptionsKey: Any]?","    ) -> Bool {","        \/\/ Override point for customization after application launch.","","        Appcues.shared.analyticsDelegate = self","","        return true","    }","}","","extension AppDelegate: AppcuesAnalyticsDelegate {","    func didTrack(analytic: AppcuesKit.AppcuesAnalytic, value: String?, properties: [String: Any]?, isInternal: Bool) {","    }","}","","extension Appcues {","    \/\/ Find your Appcues account ID in your account settings in Appcues Studio.","    \/\/ Find your Appcues application ID in your account settings under the Apps & Installation tab in Appcues Studio.","    static var shared = Appcues(config: Config(accountID: <#APPCUES_ACCOUNT_ID#>, applicationID: <#APPCUES_APPLICATION_ID#>))","}"],"identifier":"PermissionPrimers-01-04.swift","highlights":[{"line":13},{"line":14},{"line":19},{"line":20},{"line":21},{"line":22},{"line":23}],"fileName":"AppDelegate.swift","syntax":"swift"},"PermissionPrimers-02-01.png":{"alt":"Mobile Builder Create Flow dialog","identifier":"PermissionPrimers-02-01.png","variants":[{"traits":["1x","light"],"url":"\/images\/PermissionPrimers-02-01.png"},{"traits":["2x","light"],"url":"\/images\/PermissionPrimers-02-01@2x.png"}],"type":"image"},"PermissionPrimers-02-02.png":{"alt":"Mobile permission primer flow","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/PermissionPrimers-02-02.png"},{"traits":["2x","light"],"url":"\/images\/PermissionPrimers-02-02@2x.png"}],"identifier":"PermissionPrimers-02-02.png"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PermissionPrimers#In-app-configuration":{"type":"section","role":"pseudoSymbol","abstract":[{"type":"text","text":"This tutorial creates a permission primer for camera usage, but the same process can be used for other protected resources."}],"identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#In-app-configuration","title":"In-app configuration","url":"\/tutorials\/appcueskit\/permissionprimers#In-app-configuration","kind":"section"},"doc://com.appcues.sdk/tutorials/UseCases/Permission-Primers":{"type":"topic","role":"article","abstract":[],"title":"Permission Primers","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/UseCases\/Permission-Primers","url":"\/tutorials\/usecases\/permission-primers","kind":"article"},"PermissionPrimers-01-06.swift":{"syntax":"swift","identifier":"PermissionPrimers-01-06.swift","highlights":[{"line":27},{"line":28}],"content":["import UIKit","import AppcuesKit","import AVKit","","@main","class AppDelegate: UIResponder, UIApplicationDelegate {","","    func application(","        _ application: UIApplication, didFinishLaunchingWithOptions","        launchOptions: [UIApplication.LaunchOptionsKey: Any]?","    ) -> Bool {","        \/\/ Override point for customization after application launch.","","        Appcues.shared.analyticsDelegate = self","","        return true","    }","}","","extension AppDelegate: AppcuesAnalyticsDelegate {","    func didTrack(analytic: AppcuesKit.AppcuesAnalytic, value: String?, properties: [String: Any]?, isInternal: Bool) {","        if analytic == .event && value == \"request-permission-camera\" {","            let status = AVCaptureDevice.authorizationStatus(for: .video)","","            if status == .notDetermined {","                AVCaptureDevice.requestAccess(for: .video, completionHandler: { accessGranted in","                    let newStatus: AVAuthorizationStatus = accessGranted ? .authorized : .denied","                    Appcues.shared.identify(userID: userID, properties: [\"permissionStatusCamera\": \"\\(newStatus.description)\"])","                })","            }","        }","    }","}","","extension Appcues {","    \/\/ Find your Appcues account ID in your account settings in Appcues Studio.","    \/\/ Find your Appcues application ID in your account settings under the Apps & Installation tab in Appcues Studio.","    static var shared = Appcues(config: Config(accountID: <#APPCUES_ACCOUNT_ID#>, applicationID: <#APPCUES_APPLICATION_ID#>))","}"],"fileType":"swift","type":"file","fileName":"AppDelegate.swift"},"https://developer.apple.com/design/human-interface-guidelines/accessing-private-data#Pre-alert-screens":{"identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/accessing-private-data#Pre-alert-screens","type":"link","title":"Human Interface Guidelines for Pre-alert screens","titleInlineContent":[{"type":"text","text":"Human Interface Guidelines for Pre-alert screens"}],"url":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/accessing-private-data#Pre-alert-screens"},"PermissionPrimers-03-01.png":{"alt":"Audience targeting settings","identifier":"PermissionPrimers-03-01.png","variants":[{"traits":["1x","light"],"url":"\/images\/PermissionPrimers-03-01.png"},{"traits":["2x","light"],"url":"\/images\/PermissionPrimers-03-01@2x.png"}],"type":"image"},"PermissionPrimers-01-03.swift":{"syntax":"swift","identifier":"PermissionPrimers-01-03.swift","highlights":[{"line":2},{"line":6},{"line":11}],"fileType":"swift","type":"file","content":["import AppcuesKit","import AVKit","","\/\/ ...","","let cameraPermissionStatus = AVCaptureDevice.authorizationStatus(for: .video)","Appcues.shared.identify(","    userID: userID,","    properties: [","        \/\/ other user properties...","        \"permissionStatusCamera\": \"\\(cameraPermissionStatus.description)\"","    ]",")"],"fileName":"MyAppAuth.swift"},"PermissionPrimers-02-03.png":{"alt":"Mobile builder button action settings","identifier":"PermissionPrimers-02-03.png","variants":[{"traits":["1x","light"],"url":"\/images\/PermissionPrimers-02-03.png"},{"traits":["2x","light"],"url":"\/images\/PermissionPrimers-02-03@2x.png"}],"type":"image"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PermissionPrimers#Target-the-flow-in-Appcues-Studio":{"role":"pseudoSymbol","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#Target-the-flow-in-Appcues-Studio","url":"\/tutorials\/appcueskit\/permissionprimers#Target-the-flow-in-Appcues-Studio","abstract":[{"type":"text","text":"This tutorial creates a permission primer for camera usage, but the same process can be used for other protected resources."}],"type":"section","kind":"section","title":"Target the flow in Appcues Studio"},"doc://com.appcues.sdk/documentation/AppcuesKit/Appcues/analyticsDelegate":{"role":"symbol","fragments":[{"text":"var","kind":"keyword"},{"kind":"text","text":" "},{"text":"analyticsDelegate","kind":"identifier"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"c:@M@AppcuesKit@objc(pl)AppcuesAnalyticsDelegate","text":"AppcuesAnalyticsDelegate"},{"text":"?","kind":"text"}],"abstract":[{"type":"text","text":"The delegate object that observes published analytics events."}],"kind":"symbol","type":"topic","title":"analyticsDelegate","url":"\/documentation\/appcueskit\/appcues\/analyticsdelegate","identifier":"doc:\/\/com.appcues.sdk\/documentation\/AppcuesKit\/Appcues\/analyticsDelegate"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PermissionPrimers#Create-the-flow-in-Appcues-Mobile-Builder":{"role":"pseudoSymbol","url":"\/tutorials\/appcueskit\/permissionprimers#Create-the-flow-in-Appcues-Mobile-Builder","abstract":[{"type":"text","text":"This tutorial creates a permission primer for camera usage, but the same process can be used for other protected resources."}],"identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PermissionPrimers#Create-the-flow-in-Appcues-Mobile-Builder","kind":"section","type":"section","title":"Create the flow in Appcues Mobile Builder"},"doc://com.appcues.sdk/tutorials/AppcuesKit/PushNotificationsTutorial#Configure-Appcues-Studio":{"role":"pseudoSymbol","identifier":"doc:\/\/com.appcues.sdk\/tutorials\/AppcuesKit\/PushNotificationsTutorial#Configure-Appcues-Studio","url":"\/tutorials\/appcueskit\/pushnotificationstutorial#Configure-Appcues-Studio","abstract":[{"type":"text","text":"This tutorial manually configures push notifications for an app."}],"type":"section","kind":"section","title":"Configure Appcues Studio"},"PermissionPrimers-01-05.swift":{"syntax":"swift","identifier":"PermissionPrimers-01-05.swift","highlights":[{"line":3},{"line":22},{"line":23},{"line":24},{"line":25},{"line":26},{"line":27},{"line":28},{"line":29}],"content":["import UIKit","import AppcuesKit","import AVKit","","@main","class AppDelegate: UIResponder, UIApplicationDelegate {","","    func application(","        _ application: UIApplication, didFinishLaunchingWithOptions","        launchOptions: [UIApplication.LaunchOptionsKey: Any]?","    ) -> Bool {","        \/\/ Override point for customization after application launch.","","        Appcues.shared.analyticsDelegate = self","","        return true","    }","}","","extension AppDelegate: AppcuesAnalyticsDelegate {","    func didTrack(analytic: AppcuesKit.AppcuesAnalytic, value: String?, properties: [String: Any]?, isInternal: Bool) {","        if analytic == .event && value == \"request-permission-camera\" {","            let status = AVCaptureDevice.authorizationStatus(for: .video)","","            if status == .notDetermined {","                AVCaptureDevice.requestAccess(for: .video, completionHandler: { accessGranted in","                })","            }","        }","    }","}","","extension Appcues {","    \/\/ Find your Appcues account ID in your account settings in Appcues Studio.","    \/\/ Find your Appcues application ID in your account settings under the Apps & Installation tab in Appcues Studio.","    static var shared = Appcues(config: Config(accountID: <#APPCUES_ACCOUNT_ID#>, applicationID: <#APPCUES_APPLICATION_ID#>))","}"],"fileType":"swift","type":"file","fileName":"AppDelegate.swift"}}}